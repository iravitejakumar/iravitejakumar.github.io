{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogs/memoization","result":{"data":{"markdownRemark":{"html":"<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/5e1664d5cf404d725021aafe9784310c/e9beb/cover_9.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAACUklEQVQozyWRS08TYRSG52+48Be4kJioC+PCFKadKUMaQEAX6Mq4oLQz05lpS1E0gBEMbTN0rt+001YTSoIQEwS5G1DsZShTGoggKJe20rpAf4FfNXl3J0+ec96DyJRVIlGBQlUPqjC4whEKgymMTe9/ECc7FoauvB+8Me27pVEWgWyUvZjE2DUPIXMO4G9HZFeT0GMRXahC4zKNAzjzOgBjifSNzEyM+jfF3vzqq+XgdJJeVcEKP7WuzYVCtNJDiCSBjDstMBKFq0yzTGGKB4/2t8WdWItwN5KjFg7Ud7VFyRTAfGTvfK9YnDWys0uF8flJWnvajohutK6FGIUCD1Y3c82D929OgtT+wrfC96h5xqd3n+WORrbK/OeTlxtHg2v7w2uV8Jvxh4hMYzJphQEeG2BxwGLxQOujO5dT/cmKUc6VpO1z3awlCzV9qyRljyObh2MfD0YXvw7HXtxDIr0Wyd2k0LY6zGCQj/kdT7quhrvJw3TR/KXuVOPmeTRfUYySlDsVvvwIfToaW9kbig20/zPDUFbA2VUW1zhc9Tp45+23Xde3lz4UL/RCHda2K0q+IhslMXPCp0/CG8UhPdCBSBQmkqjK2gFrh6/SOEzmWqd8DSnuWnwmdfhHN+HaEP6p/pdnTyOZEr9pPH8d6EQkV5PktgIGV9lmwOFRH8HTbeveSz1BH7M8d3qhmtVEoQ4DyG+VFeNMzJT5vBGcCHQjgtsKCwcsAUuG1wIvEe1rUR43NlDhkYx+/DuxU0vuVGNQDpOvAONMTpeCu9nEzIDzL8EfXD151ODyAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"cover 9\" title=\"cover 9\" src=\"/static/5e1664d5cf404d725021aafe9784310c/fcda8/cover_9.png\" srcset=\"/static/5e1664d5cf404d725021aafe9784310c/12f09/cover_9.png 148w,\n/static/5e1664d5cf404d725021aafe9784310c/e4a3f/cover_9.png 295w,\n/static/5e1664d5cf404d725021aafe9784310c/fcda8/cover_9.png 590w,\n/static/5e1664d5cf404d725021aafe9784310c/e9beb/cover_9.png 730w\" sizes=\"(max-width: 590px) 100vw, 590px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<br>\n<h2>What is Memoization anyway?</h2>\n<p><strong>The ability to return the previously calculated value without recalculating them, on receiving same set of inputs again is basically what memoization is.</strong></p>\n<p>So whenever a Function receives the same set of input arguments it checks in its cache variable if there is a value already exists for it then returns that value or does a recalculation.</p>\n<p><img src=\"https://media.giphy.com/media/fNlRJ7Gwr4Lba/giphy.gif\"></p>\n<ul>\n<li>It Helps in reducing the <strong>computation time.</strong></li>\n<li><strong>Faster render</strong> time</li>\n</ul>\n<h3>Outline:</h3>\n<ul>\n<li>There is a summation function that adds two numbers.</li>\n<li>We create our own <code class=\"language-text\">memoization</code> function.</li>\n<li>Use <code class=\"language-text\">memoization</code> function as Higher Order Function and create an output function.</li>\n<li>Call the above Output function instead, when we need to call summation function.</li>\n</ul>\n<p><img src=\"https://media.giphy.com/media/xT0xem7ZlZ2DOYqpG0/giphy.gif\"></p>\n<p>Let's get Started.</p>\n<p>Function <code class=\"language-text\">summation</code> is our function that we are going to Memoize.\nIt is a simple function which adds two numbers and returns the result.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// Function that sums two numbers</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">summation</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'number'</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token string\">'number'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'From Summation function'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">return</span> a <span class=\"token operator\">+</span> b<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token string\">\"Invalid Entry\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>The <code class=\"language-text\">memoize</code> function takes in a function <code class=\"language-text\">fnToMemoize</code> as a single Argument and returns a <code class=\"language-text\">function</code> which can be called upon.</li>\n<li><code class=\"language-text\">memoizedCache</code> is an object where we cache our new results.</li>\n<li><code class=\"language-text\">constructPropertyFromArgs</code> is used to create a unique property name based on the argument and function we pass.We will see about that in details in next Section.</li>\n<li><code class=\"language-text\">manageInsertion</code> is used to delete the property from the cache object if the maximum size is reached.(default length : 10)</li>\n<li>First we check if the property is present in the <code class=\"language-text\">memoizedCache</code>, if yes, we return result from <code class=\"language-text\">memoizedCache</code> or we actually call the function <code class=\"language-text\">fnToMemoize</code> and store the result in the <code class=\"language-text\">memoizedCache</code>.</li>\n<li>While taking the value from the cache we move the property name in <code class=\"language-text\">insertionOrder</code> to the last (Indicating they are used recently).</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">//  `memoize` function  decides if it has to return cached value or call the summation function</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">memoize</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fnToMemoize<span class=\"token punctuation\">,</span> cacheSize</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> fnToMemoize <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Argument passed to memoize function should be a function'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> memoizedCache <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>         <span class=\"token comment\">// A closure object</span>\n    insertionOrder<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>            <span class=\"token comment\">// To preserve the order of Insertion, so that FIFO can be implemented</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span> \n  \n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> propToCheck <span class=\"token operator\">=</span> <span class=\"token function\">constructPropertyFromArgs</span><span class=\"token punctuation\">(</span>fnToMemoize<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>memoizedCache<span class=\"token punctuation\">[</span>propToCheck<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      memoizedCache<span class=\"token punctuation\">[</span>propToCheck<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">fnToMemoize</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">manageInsertion</span><span class=\"token punctuation\">(</span>memoizedCache<span class=\"token punctuation\">,</span> propToCheck<span class=\"token punctuation\">,</span> cacheSize<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span>  <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'From Cache '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// LRU logic implementation, moving the current element name to end of the array</span>\n      <span class=\"token keyword\">const</span> currIndex <span class=\"token operator\">=</span> memoizedCache<span class=\"token punctuation\">.</span>insertionOrder<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span>propToCheck<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      memoizedCache<span class=\"token punctuation\">.</span>insertionOrder<span class=\"token punctuation\">.</span><span class=\"token function\">splice</span><span class=\"token punctuation\">(</span>currIndex<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      memoizedCache<span class=\"token punctuation\">.</span>insertionOrder<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>propToCheck<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">return</span> memoizedCache<span class=\"token punctuation\">[</span>propToCheck<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>How do we construct a property name?</h2>\n<p>This is crucial, as improper naming may result in unexpected behaviour of the app.</p>\n<p>The <code class=\"language-text\">memoize</code> function can act as a generic function, through which we can memoize any of our other functions that are lying in the same scope.So, in order to avoid misbehaviour we need to have unique names to our functions.</p>\n<blockquote>\n<p>Our Property name is a combination of function name and arguments separated by <strong>'|'</strong> which acts as a <strong>delimiter.</strong></p>\n</blockquote>\n<h3>Why do we need Delimiter?</h3>\n<p>Let's say if we don't use a  Delimiter and just join the string.</p>\n<p>Here, the Property name for <code class=\"language-text\">add (fn, 1, 2, 3)</code> will be <code class=\"language-text\">fn123</code>.\nAnd, the Property name for <code class=\"language-text\">add (fn, 12, 3)</code> will also be <code class=\"language-text\">fn123</code>.</p>\n<p>So output of <code class=\"language-text\">add(fn, 12,3)</code> will be 6 which is calculated from the previous execution.</p>\n<p><img src=\"https://media.giphy.com/media/25QbQdrFvFAMcPKq24/giphy.gif\"></p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// To create a Property name from the arguments passed to the function</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">constructPropertyFromArgs</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fnToMemoize<span class=\"token punctuation\">,</span> args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> propToCheck <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  propToCheck <span class=\"token operator\">=</span> propToCheck<span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>fnToMemoize<span class=\"token punctuation\">.</span>name<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> propToCheck<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'|'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// A delimiter to join args</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Why do we need to specify the cacheSize?</h2>\n<p>Let's say if we call our <code class=\"language-text\">summation</code> function for 1000 different parameters, then our <code class=\"language-text\">memoizedCache</code> object's length would be 1000 causing higher amount of wastage in space.</p>\n<p>To avoid this by default we set the size of the object to 10 and the user can override it as per their need thus solving this issue.</p>\n<h2>How do we remove the element?</h2>\n<p>Best way would be to use LRU algorithm.Here, I keep track of element's insertion order in <code class=\"language-text\">insertionOrder</code> property and if the length is maxed out ,  I get the first value using <code class=\"language-text\">shift</code> and delete the property with that name from the <code class=\"language-text\">memoizedCache</code> object. </p>\n<blockquote>\n<p>Note: We move the property name to the end of the array, if the value is taken from the cache object.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token comment\">// To manage space complexity</span>\n<span class=\"token comment\">// To maintain only specified number of elements in the cache and deleting the others using First In First Out approach</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">manageInsertion</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">memoizedCache<span class=\"token punctuation\">,</span> propToCheck<span class=\"token punctuation\">,</span> cacheSize <span class=\"token operator\">=</span> <span class=\"token number\">10</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>memoizedCache<span class=\"token punctuation\">.</span>insertionOrder<span class=\"token punctuation\">.</span>length <span class=\"token operator\">>=</span> cacheSize<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> oldestElementName <span class=\"token operator\">=</span> memoizedCache<span class=\"token punctuation\">.</span>insertionOrder<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">delete</span> memoizedCache<span class=\"token punctuation\">[</span>oldestElementName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n   <span class=\"token punctuation\">}</span>\n   memoizedCache<span class=\"token punctuation\">.</span>insertionOrder<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>propToCheck<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Finally we pass our <code class=\"language-text\">summation</code> function to our <code class=\"language-text\">memoize</code> function that returns a function which is stored in <code class=\"language-text\">memSummation</code> and we specify the cache size to be 2.\nWhich means size of our <code class=\"language-text\">memoizedCache</code> object will never be greater than 2.</p>\n<p>Then we call <code class=\"language-text\">memSummation</code> twice.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> memSummation <span class=\"token operator\">=</span> <span class=\"token function\">memoize</span><span class=\"token punctuation\">(</span>summation<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// `memoize` is a HOC</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">memSummation</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token function\">memSummation</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">50</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>The output:</p>\n<p>First console.log() returns output after execution whereas the second one is returned from the cache.</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"> <span class=\"token string\">\"From Summation function\"</span>\n\n <span class=\"token number\">60</span>\n\n <span class=\"token string\">\"From Cache \"</span>\n\n <span class=\"token number\">60</span></code></pre></div>\n<p>Don't forget to Follow me for Interesting posts :)</p>\n<p><img src=\"https://media.giphy.com/media/fxsqOYnIMEefC/giphy.gif\"></p>\n<p>That's all Folks :)</p>","frontmatter":{"path":"/blogs/memoization","title":"Implementing Memoization in Javascript","author":"Ravi Teja Kumar","description":"To learn how to implement Memoization with simple Example","date":"Apr 21, 2019","ogimage":{"childImageSharp":{"fixed":{"src":"/static/5e1664d5cf404d725021aafe9784310c/497c6/cover_9.png"}}}}},"allMarkdownRemark":{"edges":[]}},"pageContext":{}}}